---

.build_app:
  image: $CI_REGISTRY_IMAGE/ledger-app-builder:$CI_COMMIT_REF_SLUG
  stage: build
  variables:
    DEVICE_APP: ""
    DEVICE_SDK: ""
    DEBUG: "false"
  script:
    - bash -c "make -C app BOLOS_SDK=\$${DEVICE_SDK} DEBUG=${DEBUG}"
    - cd app/bin/ && tar czf ../../app_${DEVICE_APP}.tgz .
  needs:
    - generate_builtin_patterns
  artifacts:
    paths:
      - app_${DEVICE_APP}.tgz
