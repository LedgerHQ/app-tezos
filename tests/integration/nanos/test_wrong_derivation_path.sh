start_speculos "$seed"
expect_full_text 'ready for' 'safe signing'
# INS_GET_PUBLIC_KEY
send_apdu 8002000011058000002c800006c18000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 8002000010048000002c800006c180000000800000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 80020000110b8000002c800006c1800000008000000080000000800000008000000080000000800000008000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
# INS_PROMPT_PUBLIC_KEY
send_apdu 8003000011058000002c800006c18000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 8003000010048000002c800006c180000000800000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 80030000110b8000002c800006c1800000008000000080000000800000008000000080000000800000008000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
# INS_SIGN
send_apdu 8004000011058000002c800006c18000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 8004000010048000002c800006c180000000800000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 80040000110b8000002c800006c1800000008000000080000000800000008000000080000000800000008000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
# INS_SIGN_WITH_HASH
send_apdu 800f000011058000002c800006c18000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 800f000010048000002c800006c180000000800000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
send_apdu 800f0000110b8000002c800006c1800000008000000080000000800000008000000080000000800000008000000080000000
expect_apdu_return $ERR_WRONG_LENGTH_FOR_INS
press_button right
press_button right
press_button both
expect_exited
